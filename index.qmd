En este taller vamos a ir interactuando entre algo de teoría, algo de datos y algo de código. Vamos a trabajar con un sólo insumo empírico que es una base de datos de establecimientos educativos de nivel primario de gestión estatal de la provincia de Buenos Aires. Con este insumo nos vamos a focalizar en el *diseño* de las muestras y en la construcción de ponderadores y expansores pero no vamos a ver por ahora estrategias de calibración o post-estratificación. En otras palabras, vamos a ver estrategias *ex-ante* la producción del dato primario y no vamos a ver estrategias, usualmente más realistas pero también más variables de forma circunstancial (p.e. ajuste por no respuesta ), *ex-post* producción del dato primario.

## Librerias

El código con que vamos a procesar los datos va a ser en lenguaje R. R es un lenguaje de programación que parece una opción razonable tanto para el diseño de la muestra como el posterior ajuste y análisis de los mismos. Si bien diseños de métodos de muestreo relativamente simples son posibles de realizarse varios otros lenguajes y con código R base la situación se complica un poco a medida que se quieren utilizar, y luego analizar, diseños más complejos. En esta última situación, ya no es posible conseguir librerías en muchos lenguajes.

Dentro del ecosistema de R, ejemplos de librerías para analizar datos producidos con diseños muestrales pueden considerarse [survey](https://r-survey.r-forge.r-project.org/survey/), [svrep](https://bschneidr.github.io/svrep/) y su correspondiente versión tidy [srvyr](http://gdfe.co/srvyr/). Estas librerías generalmente agregan metainformación al dataframe original que hace referencia al modo o diseño en que fue realizada la muestra. Esta información luego utilizada para realizar estimaciones puntuales con sus respectivos errores standards o intervalos de confianza. La librería survey es una librería madura mantenida principalmente por [Thomas Lumley](https://en.wikipedia.org/wiki/Thomas_Lumley_(statistician)) (un personaje conocido dentro de la comunidad de R) y la librería srvyr puede considerarse como su sucesora más moderna, aunque como lo destacan sus propios autores, se trata de una librería más amigable en donde la mayoría del trabajo sucio lo sigue haciendo por detrás la librería survey. Algo similar resulta entre la relación entre survey y svrep ya que esta última se puede considerar, para algunas tareas más complejas, una extensión de la primera. Algo no menor es que no sólo existe compatibilidad entre las 3 librerías sino que, a pesar de la diferencia generacional (Lumley es el mayor) existe una relación afectuosa entre los diferentes autores. En efecto, [Ben Schneider](https://github.com/bschneidr) es un asiduo contribuidor de los 3 paquetes.[^index-1]

Ejemplos de librerías que sirven para el diseño de las muestras y su posterior ajuste son [sampling](https://cran.r-project.org/web/packages/sampling/index.html), [balanced sampling](https://www.antongrafstrom.se/balancedsampling/) y [spbsampling](https://cran.r-project.org/web/packages/Spbsampling/index.html). Al igual que con las librerías anteriores, aquí también existe relación entre los diferentes autores. La librería sampling es una librería madura creada bajo la tutela de Yver Tillé, un personaje bastante conocido en el mundo de la estadística académica y también dentro de los organismos oficiales de estadística de diferentes países. La librería balanced sampling hace mucho de las funciones que la librería sampling, pero es más moderna (corre en C^++^) y es mantenida por [Anton Grafstrom](https://scholar.google.com/citations?user=JkMAOUEAAAAJ&hl=sv) que ha escrito con Tillé. Por otro lado, la librería spbsampling se especializa en muestreos espaciales (balanced sampling tambien tiene funciones para eso), también se ejecuta en C^++^ y es mantenida por Roberto Benedetti. Tanto Benedetti como Grafstrom se reconocen entre ellos y si, bien han trabajados con institutos oficiales de estadística, su especialización en organismos de agricultura. De ahí que ambos se focalicen en la dimensión espacial de los diseños muestrales ya que esta es útil al hora de, por ejemplo, diseñar una buena muestra de la vegetación de un bosque.[^index-2]

Por último para el cálculo de los tamaños muestrales con diferentes diseños puede consultarse la librería [PracTools](https://cran.r-project.org/web/packages/PracTools/index.html). No se trata de una libraría muy sofisticada como algunas de las anteriores pero se trata de una librería útil y relativamente bien documentada.[^index-3]

La idea sería tener instaladas estas librerías específicas, más allá de otras librerías que iremos usando en el camino.

```{r}
#| eval: false
# Código para activar librerias. Instala también las librerías que se necesitan pero no están instaladas previamente
 
install.packages("pacman", repos = "http://cran.us.r-project.org")
```

```{r}

pacman::p_load(survey,
               svrep,
               srvyr,
               sampling,
               BalancedSampling,
               Spbsampling,
               PracTools,
               tidyverse,
               janitor,
               here,
               readxl,
               gt,
               gtsummary,
               patchwork)
```

[^index-1]: Existen más librerías que extienden a survey. [robsurvey](https://cran.r-project.org/web/packages/robsurvey/index.html), para la realización de estimaciones robustas, es otro ejemplo.

[^index-2]: Para aquel que le interesa agregar explícitamente la dimensión espacial en los diseños muestrales puede consultar la obra de Dick Brus "[Spatial sampling with R](https://dickbrus.github.io/SpatialSamplingwithR/)"

[^index-3]: Otras librerías que existen dentro del ecosistema de R pero que no veremos aquí son [SamplingStrata](https://barcaroli.github.io/SamplingStrata/) y [surveyplanning](https://csblatvia.github.io/surveyplanning/)
