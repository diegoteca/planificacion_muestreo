---
title: "Azar simple"
---

Como se trata de un formato tipo taller a partir de ahora vamos a ir interactuando entre algo de teoría, algo de datos y algo de código. Por ahora vamos a trabajar con un sólo insumo que es una base de datos de establecimientos educativos de nivel primario, de gestión estatal, de la provincia de Buenos Aires y el código va a ser en lenguaje R. Por otro lado, con este insumo nos vamos a focalizar en el *diseño* de las muestras y en la construcción de ponderadores y expansores pero no vamos a ver estrategias de calibración. En otras palabras, vamos a ver estrategias *ex-ante* la producción del dato primario y no vamos a ver estrategias, usualmente más realistas pero también más variables de forma circunstancial (p.e. no respuesta ), *ex-post* producción del dato primario.

```{r}
#| label: setting

# Hay que instalar las librerias previamente sino las tienen instaladas

library(here)
library(readxl)
library(janitor)
library(tidyverse)
library(gt)
library(sampling)

i_am("azar.qmd")
```

```{=html}
<iframe 
width = 100% 
height = "500" 
src = "https://diegoteca.com.ar/SimuladorTeoremaLimiteCentral.html" 
title = "Webpage example">
</iframe>
```
```{r}
#| label: input

base = read_xlsx(here("Inputs", "base_escuelas_primaria.xlsx")) |>
clean_names()

base |>
slice_head(n = 3) |>
gt()
```

Como puede observarse se trata de una base de escuelas en el sentido que en cada fila hay un establecimiento diferente que contiene una serie de propiedades de los mismos en cada una de las columnas. Algunas de esas propiedades se podrían considerar como intrínsecas de cada escuela (clave, región, ámbito, etc.) pero otras pueden considerarse como propiedades derivadas de los establecimientos en el sentido que devienen de agregaciones de los estudiantes de cada escuela (prueba_x) o de los directivos de los mismos (direct_x). Esta distinciones son importantes cuando se quiere realizar una muestra porque esto indica posibilidades y límites sobre a qué población se puede realizar una "buena" muestra desde este archivo. En este contexto, la información de este archivo es particularmente buena para realizar una muestra de colegios pero no tan apropiada para realizar una muestra de estudiantes o directivos...al menos si se lo compara con tener acceso a lista de estudiantes o directivos con el respectivo dato de la escuela. Por ahora trabajaremos con este archivo para realizar diferentes muestras de establecimientos educativos. Un plus pedagógico de esta estrategia es que vamos a tener siempre los valores de las estimaciones de las diferentes muestras y los respectivos valores de los parámetros poblaciones para comparar resultados. Esta situación no es la usual porque si ya se tiene el parámetro poblacional no es necesario la realización de una muestra para su estimación.

## Azar simple

Dentro de los métodos aleatorios el método del azar simple (*random sampling*) es un método tradicional y particularmente útil desde un punto de vista pedagógico para comenzar ya que muchos otros métodos son variaciones (usualmente más complejas) del azar simple. En la actualidad se podría afirmar que se encuentra en el medio de un continuo de situaciones en cuando al grado de información exigida para su realización. Lo "único" que pide es una lista de "contactos" de la población que se quiere analizar. La razón por la que único y contactos se encuentran entre comillas es la siguiente. La necesidad de la una lista puede ser algo exigente en algunas investigaciones (p.e. poblaciones invisibles) aunque algo insuficiente para otras (p.e. diseños con muestras estratificadas). La idea de "contacto" es algo polisémica pero aquí apunta a que el caso seleccionado se pueda contactar de alguna forma (p.e. dirección de domicilio, mail, celular, etc.) para realizarle las observaciones/mediciones. [^azar-1]

```{r}
#| label: azar_simple
#| eval: false
set.seed(1) 

sizes <- c(100, 200, 300, 400, 500, )
sample_set <- lapply(sizes, function(i) base[sample(nrow(base), i), ])

m_azar_simple_100 = base |>
slice_sample(n = 100, replace = T)

m_azar_simple_200 = base |>
slice_sample(n = 200, replace = T)

m_azar_simple_300 = base |>
slice_sample(n = 300, replace = T)

m_azares = base |>
summary(papa = map(1:n, \(i) slice_sample(n = 100)))

m_azares_2 = replicate(2, slice_sample(base, n = 100, replace = T))

```

## Muestreo sistemático

```{r}
start <- sample(1:10, size = 1)
m_azar_sistematico_100 = base |>
  slice(seq(start, n(), by = ))
```

[^azar-1]: Más adelante veremos que el muestreo sistemático puede realizarse aún sin la presencia de una "lista" previa a la cual tengan acceso los diseñadores de la muestra aunque sí los que finalmente la ejecuten. En efecto, es compatible con reglas del tipo "Una vez con los potenciales casos a disposición eliga al primer caso, deje pasar 5 casos y seleccione al siguiente, vuelva a dejar 5 casos y elija al siguiente hasta llegar a seleccionar x casos ".
